# üê≥ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å Docker

## Docker Hub Rate Limit

–ï—Å–ª–∏ –≤—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –æ—à–∏–±–∫–æ–π:
```
toomanyrequests: You have reached your unauthenticated pull rate limit
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ
–°–∫—Ä–∏–ø—Ç `deploy.sh` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ –≤–µ—Ä—Å–∏—é –±–µ–∑ nginx, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—ã.

### –†—É—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –±–µ–∑ nginx
```bash
# –ó–∞–ø—É—Å–∫ –±–µ–∑ nginx (–±–µ–∑ SSL)
docker-compose -f docker-compose-no-nginx.yml up -d

# –î–æ—Å—Ç—É–ø –∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É: http://localhost
```

#### 2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Docker Hub (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ hub.docker.com
# –ó–∞—Ç–µ–º –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å:
docker login

# –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—ã—á–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:
./deploy.sh
```

#### 3. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

##### –û—á–∏—Å—Ç–∫–∞ Docker –∫—ç—à–∞
```bash
docker system prune -a
docker-compose down --rmi all
```

##### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
Docker Hub —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ª–∏–º–∏—Ç—ã –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.

##### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ VPN
–°–º–µ–Ω–∏—Ç–µ IP-–∞–¥—Ä–µ—Å —á–µ—Ä–µ–∑ VPN –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```bash
# –û–±—ã—á–Ω–∞—è –≤–µ—Ä—Å–∏—è
docker-compose ps

# –í–µ—Ä—Å–∏—è –±–µ–∑ nginx
docker-compose -f docker-compose-no-nginx.yml ps
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –û–±—ã—á–Ω–∞—è –≤–µ—Ä—Å–∏—è
docker-compose logs -f

# –í–µ—Ä—Å–∏—è –±–µ–∑ nginx
docker-compose -f docker-compose-no-nginx.yml logs -f

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker logs tgbot_web
docker logs tgbot_bot
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./deploy.sh restart

# –†—É—á–Ω–æ–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart
```

## –ü–µ—Ä–µ—Ö–æ–¥ —Å –≤–µ—Ä—Å–∏–∏ –±–µ–∑ nginx –Ω–∞ –ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é

–ü–æ—Å–ª–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å Docker Hub:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –±–µ–∑ nginx
docker-compose -f docker-compose-no-nginx.yml down

# –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ Docker Hub
docker login

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é —Å nginx
./deploy.sh
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSL

–ï—Å–ª–∏ nginx –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–æ –Ω—É–∂–µ–Ω SSL:

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Cloudflare Tunnel (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ cloudflare.com
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ cloudflared
3. –°–æ–∑–¥–∞–π—Ç–µ —Ç—É–Ω–Ω–µ–ª—å –∫ `localhost:8000`

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Caddy –≤–º–µ—Å—Ç–æ nginx
```dockerfile
# –î–æ–±–∞–≤—å—Ç–µ –≤ docker-compose-no-nginx.yml
caddy:
  image: caddy:alpine
  ports:
    - "80:80"
    - "443:443"
  volumes:
    - ./Caddyfile:/etc/caddy/Caddyfile
  depends_on:
    - web
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats

# –î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
docker system df

# –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
docker system prune
``` 